---
import BlogHeader from "../components/BlogHeader.astro";
import Footer from "../components/Footer.astro";
import BlogTagList from "../components/BlogTagList.astro";
import CommentsWidget from "../components/CommentsWidget.astro";
import Configure from "./Configure.astro";
import BlogYearList from "../components/BlogYearList.astro";

interface Props {
    content: {
        title: string;
        tags: string[];
        pubDate?: string;
        author: string;
        description: string;
    },
    url? : string;
}

const { content, url } = Astro.props;
const slug = url ? url.substring(6) : "";
let pubDate = content.pubDate;
if (pubDate && pubDate.includes('T')) pubDate = pubDate.slice(0, pubDate.indexOf('T'));
const metadataDisplay = pubDate ? "block" : "none";
---

<html lang="en">
<head>
    <meta charset="utf-8" />
    <link rel="icon" href="/img/favicon-32x32.png">
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <title>{content.title}</title>
    <link rel="stylesheet" href="/css/navbar.css">
    <link rel="stylesheet" href="/css/theme.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
          rel="stylesheet" crossorigin="anonymous" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65">
    <Configure/>
</head>
<body>
<BlogHeader />
<div style="display: flex; flex-direction: row; justify-content: space-between; align-items: flex-start">
    <div style="padding-left: 18px; padding-right: 18px; max-width: 1000px">
        <h1 style="margin-bottom: 16px; margin-top: 20px; font-size: 40px; font-weight: 500">{content.title}</h1>
        <p style="margin-bottom: 30px"><i>{content.description}</i></p>
        <p style=`display: ${metadataDisplay}`><b>{pubDate}, by {content.author}</b></p>
        <slot />
    </div>
    <div style="display: flex; flex-direction: column; justify-content: flex-start; align-items: flex-start">
        <BlogTagList required={content.tags}/>
        <BlogYearList/>
    </div>
</div>

{!!slug && <CommentsWidget url={"blog:" + slug} />}

<Footer views="blog" />
</body>
</html>